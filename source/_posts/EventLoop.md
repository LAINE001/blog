---
title: EventLoop
date: 2019-09-10 22:04:35
categories: javascript
type: "categories"
---

> javascript 事件循环机制

```js
  // javascript 事件循环机制分为浏览器和node事件循环机制
  // 浏览器Event Loop是HTML中定义的规范
  // Node Event Loop 是由libuv 库实现。

  JavaScript有一个main thread 主线程和call-stack调用栈（执行栈），所有的任务都会放到调用栈中等待主线程执行。
  1. JS 调用栈
    是一种先进后出的数据结构。当函数被调用时，会被添加到栈中的顶部。
    执行完成之后就从栈顶部移出该函数，直到栈内被清空。
  2. 同步任务、异步任务
    JavaScript单线程中的任务分为同步任务和异步任务。
    同步任务会在调用栈中按照顺寻排队等待主线程执行。
    异步任务则会在异步有了结果之后将注册的回调函数添加到任务队列（消息队列）中等待主线程空闲的时候，
    也就是栈内被清空的时候，被读取到栈中等待主线程执行。任务队列是先进先出的数据结构。
  3. Event Loop
    调用栈中的同步任务都型执行完毕，栈内被清空了，就代表主线程空闲了，
    这个时候就会去任务队列中按照顺序读取一个任务放入到栈中执行。
    每次栈内被清空，都会去读取任务队列，有就读取执行，一直循环-执行操作，就形成了事件循环。
```